FROM node:22-bullseye
ENV BUN_HOME="/bun"
ENV PATH="$BUN_HOME:$PATH"
RUN corepack enable

RUN apt update && apt install -y awscli jq

WORKDIR /src

COPY ../ ./
RUN bun install
RUN bun run build

WORKDIR ./apps/laboratory/

RUN bun run playwright:install

ENV TIMING_LOGS=true
ENV CI=true
ENV SKIP_PLAYWRIGHT_WEBSERVER=true
ENV BASE_URL=https://lab.reown.com/

CMD ["timeout", "600", "./docker-canary.sh"]
